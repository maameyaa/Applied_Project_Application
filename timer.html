<!DOCTYPE html>
<html lang="en">


<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <title>  MTLP - Timer</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
</head>


<body onload='getAllLessons()' >
  <nav class="light-blue lighten-1" role="navigation">
    <div class="nav-wrapper container"><a id="logo-container" href="#" class="brand-logo"><i class="large material-icons right">cloud</i></a>
      <ul class="right hide-on-med-and-down">
        <li><a class='dropdown-button btn' href="#" data-activates='dropdown1' >Menu</a></li>

        <!-- Drop down menu -->
        <ul id='dropdown1' class='dropdown-content'>
          <li><a href="dashboard.html">Dashboard</a></li>
          <li><a href="profile.html">Profile</a></li>
          <li><a href="lessons.html">Lessons</a></li>
           <li><a href="timer.html">Timer </a></li>
          <li><a href="assesment.html">Assessment</a></li>
          <li class="divider"></li>
          <li><a href="login.html">Logout</a></li>
        </ul>
      </ul>

      <ul id="nav-mobile" class="side-nav">
         <li><a href="dashboard.html">Dashboard</a></li>
          <li><a href="profile.html">Profile</a></li>
          <li><a href="lessons.html">Lessons</a></li>
          <li><a href="timer.html">Teaching </a></li>
          <li><a href="assesment.html">Coahing</a></li>
          <li><a href="logout.html">Logout</a></li>
      </ul>
      <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
    </div>
  </nav>

  <div class="container">
    <div class="section">
     
      <!--   Search Section   -->
      <div class="row"> 
        <div class="col s12">
        <h4>Timer</h4>
        <h5>Select a lesson to start the timer</h5>
        </div>
      </div>
   
      <div>
          <div id=tabs-fixed-width class="col s12" >
            <ul class="tabs">
              <li class="tab col s3"><a class="active" href="#Twi">Akaupem Twi</a></li>
              <li class="tab col s3"><a href="#English">English</a></li>
            </ul>
          </div>

          <center><div id="divStatus" class="status"></div></center>

          <div id="Twi" class="twi-row" ></div>

          <div id="English" class="eng-row"></div>




      </div>
    </div>
  </div>

  
  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>
  <script src="js/init.js"></script>
  <script type="text/javascript">


$(function() {  

  getTwilessons();
  getEnglessons();

  });
    function getAllLessons(){
       
    }

    function getTwilessons(){
        var ajaxPageUrl="http://mtlp-application.000webhostapp.com/Applied_Project_Application/lessonajax.php?cmd=2&lang=Twi";

        $.ajax(ajaxPageUrl,
          {async:true,
           complete:getTwilessonscomplete});
    }

    function getEnglessons(){
        var ajaxPageUrl="http://mtlp-application.000webhostapp.com/Applied_Project_Application/lessonajax.php?cmd=2&lang=English";

        $.ajax(ajaxPageUrl,
          {async:true,
           complete:getEnglessonscomplete});
    }

    function getTwilessonscomplete(xhr,status){
        if(status!="success"){

            $('#divStatus').html("Error while getting lessons");

         return;    
         }

          var obj=$.parseJSON(xhr.responseText);
          console.log(obj.result);


          if(obj.result==0){

          $('#divStatus').html("No Lessons");
          return;

          }

          else{
            var length=obj.length;
            var count=1;

            for(var i=0; i<length; i++){
              $('.twi-row').append
              ("<a id='"+i+"'>"+ "<div class='card' onclick='clicked("+obj[i].lesson_id+",&apos;"+obj[i].language+"&apos;)' class='rowgrid'"+"<h3 class=''>Lesson "+count+":  Week "+obj[i].week+" Day "+obj[i].day+ "</h5><br></br>"
                )
              count ++;
            }
          }
    }

    function getEnglessonscomplete(xhr,status){
        if(status!="success"){

            $('#divStatus').html("Error while getting lessons");

         return;    
         }

          var obj=$.parseJSON(xhr.responseText);
          console.log(obj.result);


          if(obj.result==0){

          $('#divStatus').html("No Lessons");
          return;

          }

          else{
            var length=obj.length;
            var count=1;

            for(var i=0; i<length; i++){
              // alert(obj[i].language);
              $('.eng-row').append
              ("<a id='"+i+"'>"+ "<div class = 'card' onclick='clicked("+obj[i].lesson_id+",&apos;"+obj[i].language+"&apos;)' class='rowgrid'"+"<h3 class=''>Lesson "+count+":  Week "+obj[i].week+" Day "+obj[i].day+"</h5><br></br>"
                )
              count ++;
            }
          }

    }
      
      function getTime(){
        var ajaxPageUrl="http://mtlp-application.000webhostapp.com/Applied_Project_Application/timerajax.php?cmd=1&lid="+lesson_id+"";

        $.ajax(ajaxPageUrl,
          {async:true,
           complete:getTimeComplete});
    }
      
    function getTimeComplete(xhr,status){
       if(status!="success"){

            $('#divStatus').html("Error while getting time");

         return;    
         }

          var obj=$.parseJSON(xhr.responseText);
          console.log(obj);

          //alert(obj);

          if(obj.result==0){

          $('#divStatus').html("Error getting time");
          return;

          }

          else{

            sessionStorage.mintime = obj[0].revision_min;
            sessionStorage.maxtime = obj[0].revision_max;
              
            sessionStorage.phonemic = obj[0].phonemic_min;
            sessionStorage.vocab = obj[0].vocab_min;
            sessionStorage.comp = obj[0].comp_min;
            sessionStorage.lookingAhead = obj[0].lookingAhead_min;
            sessionStorage.readingComp = obj[0].readingComp_min;
            sessionStorage.phonics = obj[0].phonics_min;  
            sessionStorage.writing = obj[0].writing_min;  
            sessionStorage.fluency = obj[0].fluency_min;  
              
                    
            sessionStorage.section = "Revision";

            //alert( sessionStorage.mintime);
            // alert( sessionStorage.maxtime);

          }
    }

    function clicked(lid, lang){
      var lesson_id = lid;
      var lang = lang;

      sessionStorage.lid=lesson_id;
      sessionStorage.lang=lang;
      sessionStorage.count = 0;

      // alert(sessionStorage.lang);

      window.location.href ="timerstart.html";
    }
   </script>
  </body>
</html>
